<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Picks</title>

<link rel="manifest" href="../manifest.json">
<meta name="theme-color" content="#0f172a">
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  :root{
    --bg:#f7f9fc; --card:#fff; --text:#0f172a; --muted:#475569; --line:#e2e8f0;
    --goodbg:#dcfce7; --good:#166534; --badbg:#fee2e2; --bad:#7f1d1d;
    --blue:#1d4ed8; --blue2:#2563eb;
  }
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto;background:var(--bg);margin:0;padding:18px;color:var(--text)}
  .wrap{max-width:1200px;margin:0 auto}
  .topnav{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:14px}
  .topnav a{display:inline-block;text-decoration:none;font-weight:900;color:var(--text);
    padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:#fff}
  .topnav a:hover{background:#f1f5f9}
  h1{margin:6px 0 6px;font-size:34px}
  .sub{margin:0 0 14px;color:var(--muted);font-size:13px;line-height:1.35}
  .card{background:var(--card);border-radius:16px;padding:16px;margin-bottom:14px;
    box-shadow:0 2px 10px rgba(0,0,0,.06);border:1px solid rgba(226,232,240,.7)}
  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  .badge{display:inline-block;padding:2px 10px;border-radius:999px;font-size:12px;font-weight:900;vertical-align:middle}
  .good{background:var(--goodbg);color:var(--good)}
  .bad{background:var(--badbg);color:var(--bad)}
  code{background:#f3f4f6;padding:2px 6px;border-radius:8px}
  .btn{padding:10px 12px;border-radius:12px;border:1px solid var(--line);font-weight:900;cursor:pointer;background:#fff}
  .btn:active{transform:translateY(1px)}
  .btnPrimary{background:var(--blue);border-color:var(--blue);color:#fff}
  .btnPrimary:hover{background:var(--blue2)}
  .btn[disabled]{opacity:.5;cursor:not-allowed}
  select{padding:10px 12px;font-size:14px;border-radius:12px;border:1px solid #cbd5e1;background:#fff;font-weight:900}
  label{font-weight:1000}
  table{width:100%;border-collapse:collapse;font-size:14px}
  th,td{border-bottom:1px solid var(--line);padding:10px;text-align:left;vertical-align:top}
  thead th{background:#f1f5f9;position:sticky;top:0;z-index:2}
  tbody tr:nth-child(even){background:#f8fafc}
  .mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
  .kpi{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  .kpi .pill{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:4px 10px;font-size:12px;font-weight:1000;background:#fff}
  .chk{display:flex;align-items:center;gap:8px}
  .chk input{transform:scale(1.2)}
  .groupRow td{
    background:#eef2ff !important;
    font-weight:1000;
    border-top:1px solid var(--line);
    border-bottom:1px solid var(--line);
    position:sticky;
    top:44px;
    z-index:1;
  }
  .groupTag{
    display:inline-block;
    padding:2px 10px;
    border-radius:999px;
    background:#dbeafe;
    border:1px solid #bfdbfe;
    font-size:12px;
    font-weight:1000;
    margin-left:8px;
  }
  .hide{display:none}
</style>
</head>

<body>
<div class="wrap">

  <nav class="topnav">
    <a href="../">üè† Home</a>
    <a href="../bin/">üìç Bin Lookup</a>
    <a href="../transfers/">üì¶ Picks</a>
    <a href="../putaway/">üßæ Scan + Putaway</a>
  </nav>

  <h1>Picks</h1>
  <p class="sub">
    Builds a pick using your rule: <code>Destination On Hand &lt; Destination Min</code> ‚Üí fill toward <code>Destination Max</code>, limited by source availability.
    Excludes items with 0 source availability or 0 pick.
  </p>

  <div class="card">
    <div id="status"><span class="badge bad">Not loaded</span> Waiting‚Ä¶</div>
    <div id="meta" class="sub" style="margin-top:8px"></div>

    <div class="row" style="margin-top:10px">
      <button class="btn" type="button" onclick="loadCSV()">Reload from site</button>
      <button class="btn" type="button" onclick="openCSV()">Open CSV</button>
    </div>
  </div>

  <div class="card">
    <div style="font-weight:1000;margin-bottom:6px">Transfer lane</div>
    <div class="sub" style="margin-top:0">
      Pick FROM one location and send TO another. Or choose <strong>Both</strong> to build a single pick that splits quantities by destination.
    </div>

    <div class="row" style="margin-top:10px">
      <label>Pick FROM:</label>
      <select id="fromLoc">
        <option value="warehouse">Warehouse-66</option>
        <option value="container">Container - PLY</option>
        <option value="green">Green Harbor</option>
        <option value="plymouth">Plymouth</option>
      </select>


      <div class="chk" id="fallbackWrap" title="When Pick FROM = Warehouse-66: if WH availability is 0 for a SKU, pull from Container - PLY instead">
        <input id="fallbackWHToContainer" type="checkbox" checked>
        <label for="fallbackWHToContainer" style="font-weight:900">WH ‚Üí Container fallback</label>
      </div>

      <label>Pick TO:</label>
      <select id="toLoc">
        <option value="plymouth">Plymouth</option>
        <option value="green">Green Harbor</option>
        <option value="both">Both (PLY + GH)</option>
      </select>

      <label>Pick Order:</label>
      <select id="pickOrder">
        <option value="default">Default</option>
        <option value="binwalk" selected>Bin Walk (Bay‚ÜíShelf‚ÜíBin)</option>
        <option value="title">Title</option>
      </select>

      <div class="chk" title="Insert Bay headers (BB01, BB02...) when sorting by bins">
        <input id="groupHeaders" type="checkbox" checked>
        <label for="groupHeaders" style="font-weight:900">Bay Headers</label>
      </div>

      <button id="buildBtn" class="btn btnPrimary" type="button">Build Pick</button>
      <button id="downloadBtn" class="btn" type="button" disabled>Download CSV</button>
    </div>

    <div class="kpi" id="summary"></div>
  </div>

  <div class="card">
    <div class="row" style="justify-content:space-between">
      <div style="font-weight:1000">Pick results</div>
      <div class="sub" id="hint"></div>
    </div>

    <div style="overflow:auto;max-height:60vh;margin-top:10px">
      <table>
        <thead>
          <tr>
            <th style="min-width:170px">Barcode</th>
            <th style="min-width:320px">Title</th>
            <th style="min-width:140px">Option1</th>
            <th style="min-width:140px">WH Bin</th>

            <th style="min-width:160px">FROM (actual)</th>
            <th style="min-width:110px">Source Avail</th>
            <th id="thPLY" style="min-width:90px">PLY</th>
            <th id="thGH" style="min-width:90px">GH</th>

            <th style="min-width:140px">Lane</th>
          </tr>
        </thead>
        <tbody id="results"></tbody>
      </table>
    </div>
  </div>

</div>

<script>
  const CSV_URL = '../pickle-data.csv';

  // Shopify export columns used by current tool
  const COL_BARCODE = 'Variant Barcode';
  const COL_SKU = 'Variant SKU'; // still used internally, not exported
  const COL_TITLE = 'Title';
  const COL_OPT1 = 'Option1 Value';
  const COL_OPT2 = 'Option2 Value';
  const COL_WH_BIN = 'Variant Metafield: custom.wh_bin [single_line_text_field]';

  const COL_PLY_ON = 'Inventory Available: Plymouth';
  const COL_GH_ON  = 'Inventory Available: Green Harbor';
  const COL_WH_AV  = 'Inventory Available: Warehouse-66';
  const COL_CONT_AV = 'Inventory Available: Container - PLY';

  const COL_PLY_MIN = 'Variant Metafield: custom.minply [number_integer]';
  const COL_PLY_MAX = 'Variant Metafield: custom.maxply [number_integer]';
  const COL_GH_MIN  = 'Variant Metafield: custom.mingh [number_integer]';
  const COL_GH_MAX  = 'Variant Metafield: custom.maxgh [number_integer]';

  let rows = [];
  let lastPick = [];

  const statusEl = document.getElementById('status');
  const metaEl = document.getElementById('meta');
  const resultsEl = document.getElementById('results');
  const summaryEl = document.getElementById('summary');
  const hintEl = document.getElementById('hint');
  const downloadBtn = document.getElementById('downloadBtn');

  function setStatus(ok, msg){
    statusEl.innerHTML = `<span class="badge ${ok ? 'good' : 'bad'}">${ok ? 'Loaded' : 'Failed'}</span> ${msg}`;
  }
  function setMeta(html){ metaEl.innerHTML = html || ''; }
  function fmtDate(d){ try{ return new Date(d).toLocaleString(); } catch { return String(d||''); } }

  function detectDelimiter(text) {
    const firstLine = (text.split(/\r?\n/).find(l => l.trim() !== '') || '');
    const candidates = [',',';','\t','|'];
    let best = ',', bestCount = -1;
    for (const d of candidates) {
      const c = firstLine.split(d).length;
      if (c > bestCount) { bestCount = c; best = d; }
    }
    return best;
  }

  function parseCSV(text, delimiter) {
    const out = [];
    let i = 0, field = '', row = [], inQuotes = false;
    if (text.charCodeAt(0) === 0xFEFF) text = text.slice(1);

    while (i < text.length) {
      const c = text[i];
      if (c === '"') {
        if (inQuotes && text[i+1] === '"') { field += '"'; i++; }
        else { inQuotes = !inQuotes; }
      } else if (c === delimiter && !inQuotes) {
        row.push(field); field = '';
      } else if ((c === '\n' || c === '\r') && !inQuotes) {
        if (field !== '' || row.length) { row.push(field); out.push(row); row = []; field = ''; }
        if (c === '\r' && text[i+1] === '\n') i++;
      } else {
        field += c;
      }
      i++;
    }
    if (field !== '' || row.length) { row.push(field); out.push(row); }
    return out;
  }

  function toObjects(matrix) {
    if (!matrix.length) return [];
    const headers = (matrix[0] || []).map(h => String(h ?? '').trim());
    const objects = [];
    for (let r = 1; r < matrix.length; r++) {
      const line = matrix[r];
      if (!line || !line.length) continue;
      if (line.join('').trim() === '') continue;
      const obj = {};
      for (let c = 0; c < headers.length; c++) obj[headers[c]] = (line[c] ?? '').trim();
      objects.push(obj);
    }
    return objects;
  }

  function n(v) {
    const s = String(v ?? '').replace(/[^0-9.\-]/g,'').trim();
    if (!s) return 0;
    const x = Number(s);
    return Number.isFinite(x) ? x : 0;
  }

  function todayISO(){
    return new Date().toLocaleDateString('en-CA'); // YYYY-MM-DD
  }

  function locLabel(v){
    if (v === 'warehouse') return 'Warehouse-66';
    if (v === 'container') return 'Container - PLY';
    if (v === 'green') return 'Green Harbor';
    return 'Plymouth';
  }

  // ASCII lane label for CSV title (avoid Excel weirdness)
  function laneLabelAscii(from, to){
    const fromLabel = locLabel(from);
    const toLabel = (to === 'both') ? 'Both' : locLabel(to);
    return `${fromLabel} -> ${toLabel}`;
  }

  function safeFilename(name){
    return String(name || 'pick')
      .replace(/[^\x20-\x7E]/g, '')     // strip non-ASCII
      .replace(/[\/\\?%*:|"<>]/g, '-')  // illegal filename chars
      .replace(/\s+/g, ' ')
      .trim()
      .replace(/ /g, '_');
  }

  function needToMaxIfTriggered(onHand, min, max){
    if (!(onHand < min)) return 0;
    return Math.max(max - onHand, 0);
  }

  function parseWhBin(raw){
    const s = String(raw || '').trim().toUpperCase();
    const m = s.match(/^([A-Z]{2}\d{2})-(\d{2})-(\d{2})$/);
    if (m){
      const bay = m[1];
      const shelf = Number(m[2]);
      const bin = Number(m[3]);
      return { bay, shelf, bin, ok:true };
    }
    return { bay:'ZZZ', shelf:999, bin:999, ok:false };
  }

  function compareBinWalk(a, b){
    const pa = a._binParsed, pb = b._binParsed;
    if (pa.bay !== pb.bay) return pa.bay < pb.bay ? -1 : 1;
    if (pa.shelf !== pb.shelf) return pa.shelf - pb.shelf;
    if (pa.bin !== pb.bin) return pa.bin - pb.bin;

    const ta = (a.title || '').toUpperCase();
    const tb = (b.title || '').toUpperCase();
    if (ta !== tb) return ta < tb ? -1 : 1;

    const ba = String(a.barcode || '');
    const bb = String(b.barcode || '');
    if (ba !== bb) return ba < bb ? -1 : 1;

    return 0;
  }

  function compareTitle(a, b){
    const ta = (a.title || '').toUpperCase();
    const tb = (b.title || '').toUpperCase();
    if (ta !== tb) return ta < tb ? -1 : 1;
    const ba = String(a.barcode || '');
    const bb = String(b.barcode || '');
    if (ba !== bb) return ba < bb ? -1 : 1;
    return 0;
  }

  function updateTableColumns(){
    const to = document.getElementById('toLoc').value;
    const thPLY = document.getElementById('thPLY');
    const thGH = document.getElementById('thGH');

    if (to === 'plymouth'){
      thPLY.classList.remove('hide');
      thGH.classList.add('hide');
    } else if (to === 'green'){
      thPLY.classList.add('hide');
      thGH.classList.remove('hide');
    } else {
      thPLY.classList.remove('hide');
      thGH.classList.remove('hide');
    }
  }

  function updateFallbackVisibility(){
    const from = document.getElementById('fromLoc').value;
    const wrap = document.getElementById('fallbackWrap');
    if (!wrap) return;
    if (from === 'warehouse') wrap.classList.remove('hide');
    else wrap.classList.add('hide');
  }

  async function loadCSV(){
    setStatus(false, 'Loading‚Ä¶');
    setMeta('');
    try{
      const url = CSV_URL + '?v=' + Date.now();
      const res = await fetch(url, { cache: 'no-store' });
      if(!res.ok) throw new Error(`HTTP ${res.status}`);

      const lastModified = res.headers.get('last-modified');
      const etag = res.headers.get('etag');

      const text = await res.text();
      const delim = detectDelimiter(text);
      rows = toObjects(parseCSV(text, delim));

      lastPick = [];
      resultsEl.innerHTML = '';
      summaryEl.innerHTML = '';
      hintEl.textContent = 'Build a pick to see results.';
      downloadBtn.disabled = true;

      setStatus(true, `Parsed ${rows.length} rows`);
      setMeta(`
        <div><strong>CSV file:</strong> <code>${CSV_URL}</code></div>
        <div><strong>CSV Last Updated (server):</strong> ${lastModified ? fmtDate(lastModified) : 'Unknown'}</div>
        <div><strong>Loaded at (this device):</strong> ${new Date().toLocaleString()}</div>
        ${etag ? `<div><strong>ETag:</strong> <code class="mono">${etag}</code></div>` : ''}
      `);
    }catch(e){
      rows = [];
      lastPick = [];
      resultsEl.innerHTML = '';
      summaryEl.innerHTML = '';
      hintEl.textContent = '';
      downloadBtn.disabled = true;
      setStatus(false, `Couldn‚Äôt load <code>${CSV_URL}</code> ‚Äî ${e.message}`);
      setMeta(`<div style="color:#7f1d1d"><strong>Tip:</strong> Confirm <code>${CSV_URL}</code> exists in the repo root.</div>`);
    }
  }

  function openCSV(){ window.open(CSV_URL, '_blank', 'noopener'); }

  function buildPick(){
    updateTableColumns();

    if(!rows.length){
      setStatus(false, 'No data loaded');
      return;
    }

    const from = document.getElementById('fromLoc').value;
    const to = document.getElementById('toLoc').value;
    const pickOrder = document.getElementById('pickOrder').value;
    const groupHeaders = document.getElementById('groupHeaders').checked;

    if(to !== 'both' && from === to){
      setStatus(false, 'From and To cannot be the same');
      downloadBtn.disabled = true;
      return;
    }

    const picks = [];
    let totalUnits = 0;
    let totalPLY = 0;
    let totalGH = 0;

    for(const r of rows){
      const whAvail = n(r[COL_WH_AV]);
      const contAvail = n(r[COL_CONT_AV]);

      const fallbackEnabled = document.getElementById('fallbackWHToContainer')?.checked ?? true;
      let sourceAvail = 0;
      let actualFrom = from;

      if (from === 'warehouse' && fallbackEnabled) {
        // WH first; ONLY if WH is 0 for this SKU, use Container
        if (whAvail > 0) {
          sourceAvail = whAvail;
          actualFrom = 'warehouse';
        } else if (contAvail > 0) {
          sourceAvail = contAvail;
          actualFrom = 'container';
        } else {
          sourceAvail = 0;
        }
      } else {
        sourceAvail =
          (from === 'warehouse') ? whAvail :
          (from === 'container') ? contAvail :
          (from === 'green') ? n(r[COL_GH_ON]) :
          n(r[COL_PLY_ON]);
      }

      if(sourceAvail <= 0) continue;

      const plyOn  = n(r[COL_PLY_ON]);
      const plyMin = n(r[COL_PLY_MIN]);
      const plyMax = n(r[COL_PLY_MAX]);

      const ghOn   = n(r[COL_GH_ON]);
      const ghMin  = n(r[COL_GH_MIN]);
      const ghMax  = n(r[COL_GH_MAX]);

      let plyPick = 0, ghPick = 0;

      if(to === 'both'){
        const needPLY = needToMaxIfTriggered(plyOn, plyMin, plyMax);
        const needGH  = needToMaxIfTriggered(ghOn, ghMin, ghMax);
        if(needPLY <= 0 && needGH <= 0) continue;

        plyPick = Math.min(needPLY, sourceAvail);
        const remaining = Math.max(sourceAvail - plyPick, 0);
        ghPick = Math.min(needGH, remaining);

        if(plyPick <= 0 && ghPick <= 0) continue;
      } else {
        const destOn  = (to === 'plymouth') ? plyOn : ghOn;
        const destMin = (to === 'plymouth') ? plyMin : ghMin;
        const destMax = (to === 'plymouth') ? plyMax : ghMax;

        const need = needToMaxIfTriggered(destOn, destMin, destMax);
        if(need <= 0) continue;

        const pickQty = Math.min(need, sourceAvail);
        if(pickQty <= 0) continue;

        if(to === 'plymouth') plyPick = pickQty;
        if(to === 'green') ghPick = pickQty;
      }

      totalUnits += (plyPick + ghPick);
      totalPLY += plyPick;
      totalGH += ghPick;

      const whbinRaw = r[COL_WH_BIN] || '';
      const parsed = parseWhBin(whbinRaw);

      picks.push({
        barcode: r[COL_BARCODE] || '',
        sku: r[COL_SKU] || '',
        title: r[COL_TITLE] || '',
        opt1: r[COL_OPT1] || '',
        opt2: r[COL_OPT2] || '',
        whbin: whbinRaw,
        actualFrom,
        sourceAvail,
        plyPick,
        ghPick,

        lane: (to === 'both')
          ? `${locLabel(actualFrom)} ‚Üí Both`
          : `${locLabel(actualFrom)} ‚Üí ${locLabel(to)}`,

        _binParsed: parsed
      });
    }

    if (pickOrder === 'binwalk') picks.sort(compareBinWalk);
    else if (pickOrder === 'title') picks.sort(compareTitle);

    resultsEl.innerHTML = '';
    let currentBay = null;
    const useHeaders = (pickOrder === 'binwalk') && groupHeaders;

    for(const p of picks){
      if (useHeaders){
        const bayLabel = p._binParsed.ok ? p._binParsed.bay : 'NO BIN';
        if (bayLabel !== currentBay){
          currentBay = bayLabel;
          const trGroup = document.createElement('tr');
          trGroup.className = 'groupRow';
          trGroup.innerHTML = `<td colspan="9">
            ${bayLabel}
            <span class="groupTag">${(bayLabel === 'NO BIN') ? 'needs bin' : 'bay'}</span>
          </td>`;
          resultsEl.appendChild(trGroup);
        }
      }

      const tr = document.createElement('tr');
      const toMode = document.getElementById('toLoc').value;

      const tdPLY = `<td class="${toMode==='green' ? 'hide' : ''}"><strong>${p.plyPick}</strong></td>`;
      const tdGH  = `<td class="${toMode==='plymouth' ? 'hide' : ''}"><strong>${p.ghPick}</strong></td>`;

      tr.innerHTML = `
        <td class="mono">${p.barcode}</td>
        <td>${p.title}</td>
        <td>${p.opt1}</td>
        <td class="mono">${p.whbin}</td>

        <td><strong>${locLabel(p.actualFrom)}</strong></td>
        <td><strong>${p.sourceAvail}</strong></td>
        ${tdPLY}
        ${tdGH}

        <td>${p.lane}</td>
      `;
      resultsEl.appendChild(tr);
    }

    lastPick = picks;

    const lane = (to === 'both')
      ? `${locLabel(from)} ‚Üí Both`
      : `${locLabel(from)} ‚Üí ${locLabel(to)}`;

    summaryEl.innerHTML = `
      <span class="pill"><strong>Lane:</strong> ${lane}</span>
      <span class="pill"><strong>Lines:</strong> ${picks.length}</span>
      <span class="pill"><strong>Units:</strong> ${totalUnits}</span>
      <span class="pill"><strong>PLY Units:</strong> ${totalPLY}</span>
      <span class="pill"><strong>GH Units:</strong> ${totalGH}</span>
      <span class="pill"><strong>Order:</strong> ${document.getElementById('pickOrder').selectedOptions[0].text}</span>
    `;

    hintEl.textContent = picks.length ? 'Review then download the pick CSV.' : 'No items matched the rule for this lane.';
    downloadBtn.disabled = picks.length === 0;

    setStatus(true, `Built ${picks.length} pick lines`);
  }

  function downloadPick(){
    if(!lastPick.length){
      setStatus(false, 'No pick built yet');
      return;
    }

    const from = document.getElementById('fromLoc').value;
    const to = document.getElementById('toLoc').value;

    // Title once at top only (no repeat in header row)
    const pickTitle = `${laneLabelAscii(from, to)} Pick - ${todayISO()}`;

    const esc = (v) => {
      const s = v == null ? '' : String(v);
      return /[",\n]/.test(s) ? `"${s.replace(/"/g,'""')}"` : s;
    };

    // Dynamic columns (keep single-location picks clean)
    const cols = ['barcode','title','option1','wh_bin','from_actual','source_avail'];
    if (to === 'plymouth') cols.push('PLY');
    else if (to === 'green') cols.push('GH');
    else cols.push('PLY','GH');

    const out = [];
    out.push([pickTitle]);
    out.push(['']);
    out.push(cols);

    for(const p of lastPick){
      const barcode = p.barcode ? `="${String(p.barcode).replace(/"/g,'""')}"` : '';

      const row = [
        barcode,
        p.title,
        p.opt1,
        p.whbin,
        locLabel(p.actualFrom),
        p.sourceAvail
      ];

      if (to === 'plymouth') row.push(p.plyPick);
      else if (to === 'green') row.push(p.ghPick);
      else row.push(p.plyPick, p.ghPick);

      out.push(row);
    }

    const csv = out.map(r => r.map(esc).join(',')).join('\n');

    // UTF-8 BOM for Excel
    const blob = new Blob(["\uFEFF" + csv], {type:'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);

    const a = document.createElement('a');
    a.href = url;
    a.download = `${safeFilename(pickTitle)}.csv`;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);

    setStatus(true, 'Downloaded CSV');
  }

  document.getElementById('buildBtn').addEventListener('click', buildPick);
  document.getElementById('downloadBtn').addEventListener('click', downloadPick);
  document.getElementById('toLoc').addEventListener('change', updateTableColumns);
  document.getElementById('fromLoc').addEventListener('change', updateFallbackVisibility);

  loadCSV();
  updateTableColumns();
  updateFallbackVisibility();
</script>

<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('../sw.js').catch(()=>{});
    });
  }
</script>

</body>
</html>
